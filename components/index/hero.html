<!-- Hero Section -->
<section id="hero" class="hero-section">
    <div class="hero-background">
        <video class="hero-video" autoplay muted loop playsinline>
            <source src="./assets/videos/hero-video-2-eng.mp4" type="video/mp4">
            <source src="./assets/videos/hero-video-2-eng.webm" type="video/webm">
            <img src="./assets/images/index/hero/epc-bg.jpg" alt="YPP EPC 배경" class="hero-bg-fallback">
        </video>
        <div class="video-overlay"></div>
    </div>
    
    <!-- 동영상 재생 버튼 -->
    <div class="video-play-button">
        <button onclick="window.YPP.openVideoPopup()" class="play-btn">
            <svg width="24" height="24" viewBox="0 0 24 24" fill="none">
                <path d="M8 5v14l11-7L8 5z" fill="currentColor"/>
            </svg>
            <span>동영상 보기</span>
        </button>
    </div>
    
    <div class="scroll-indicator">
        <span class="scroll-text">Scroll Down</span>
        <div class="scroll-arrow"></div>
    </div>
</section>

<!-- 동영상 팝업 -->
<div id="video-popup" class="video-popup">
    <div class="video-popup-overlay" onclick="window.YPP.closeVideoPopup()"></div>
    <div class="video-popup-content">
        <div class="video-popup-header">
            <h3>YPP EPC 소개영상</h3>
            <button class="video-popup-close" onclick="window.YPP.closeVideoPopup()">✕</button>
        </div>
        <div class="video-popup-body">
            <video id="popup-video" controls preload="none">
                <source src="./assets/videos/hero-video-2-eng.mp4" type="video/mp4">
                <source src="./assets/videos/hero-video-2-eng.webm" type="video/webm">
                <p>브라우저가 동영상을 지원하지 않습니다.</p>
            </video>
        </div>
    </div>
</div>

<style>
/* 동영상 재생 버튼 */
.video-play-button {
    position: absolute;
    top: 50%;
    left: 50%;
    transform: translate(-50%, -50%);
    z-index: 10;
}

.play-btn {
    display: flex;
    align-items: center;
    gap: 0.75rem;
    padding: 1rem 2rem;
    background: rgba(255, 255, 255, 0.2);
    backdrop-filter: blur(20px);
    border: 2px solid rgba(255, 255, 255, 0.3);
    border-radius: 50px;
    color: var(--white);
    font-size: 1.1rem;
    font-weight: 600;
    cursor: pointer;
    transition: all 0.3s ease;
    text-decoration: none;
}

.play-btn:hover {
    background: rgba(255, 255, 255, 0.3);
    border-color: rgba(255, 255, 255, 0.5);
    transform: scale(1.05);
}

.play-btn svg {
    width: 20px;
    height: 20px;
}

/* 동영상 팝업 */
.video-popup {
    position: fixed;
    top: 0;
    left: 0;
    width: 100%;
    height: 100%;
    z-index: 1500;
    display: none;
    align-items: center;
    justify-content: center;
    padding: 2rem;
}

.video-popup.active {
    display: flex;
}

.video-popup-overlay {
    position: absolute;
    top: 0;
    left: 0;
    width: 100%;
    height: 100%;
    background: rgba(0, 0, 0, 0.8);
    cursor: pointer;
}

.video-popup-content {
    position: relative;
    background: var(--white);
    border-radius: 15px;
    width: 100%;
    max-width: 900px;
    max-height: 90vh;
    overflow: hidden;
    box-shadow: 0 20px 40px rgba(0, 0, 0, 0.3);
    animation: popupSlideIn 0.3s ease;
}

@keyframes popupSlideIn {
    from {
        opacity: 0;
        transform: scale(0.9) translateY(-20px);
    }
    to {
        opacity: 1;
        transform: scale(1) translateY(0);
    }
}

.video-popup-header {
    display: flex;
    justify-content: space-between;
    align-items: center;
    padding: 1.5rem 2rem;
    border-bottom: 1px solid var(--border-color);
    background: var(--primary-blue);
}

.video-popup-header h3 {
    color: var(--white);
    margin: 0;
    font-size: 1.25rem;
}

.video-popup-close {
    background: none;
    border: none;
    color: var(--white);
    font-size: 1.5rem;
    cursor: pointer;
    padding: 0.5rem;
    border-radius: 50%;
    transition: all 0.3s ease;
    width: 40px;
    height: 40px;
    display: flex;
    align-items: center;
    justify-content: center;
}

.video-popup-close:hover {
    background: rgba(255, 255, 255, 0.2);
}

.video-popup-body {
    padding: 0;
}

.video-popup-body video {
    width: 100%;
    height: auto;
    max-height: 70vh;
    display: block;
}

/* 모바일 반응형 */
@media (max-width: 768px) {
    .video-popup {
        padding: 1rem;
    }
    
    .video-popup-content {
        max-width: 100%;
    }
    
    .video-popup-header {
        padding: 1rem 1.5rem;
    }
    
    .video-popup-header h3 {
        font-size: 1.1rem;
    }
    
    .play-btn {
        padding: 0.875rem 1.5rem;
        font-size: 1rem;
    }
    
    .play-btn svg {
        width: 18px;
        height: 18px;
    }
}

/* 키보드 접근성 */
.play-btn:focus,
.video-popup-close:focus {
    outline: 2px solid rgba(255, 255, 255, 0.8);
    outline-offset: 2px;
}
</style>

<script>
// 동영상 팝업 함수들 - 네임스페이스 사용
window.YPP = window.YPP || {};

window.YPP.openVideoPopup = function() {
    const popup = document.getElementById('video-popup');
    const video = document.getElementById('popup-video');
    
    if (popup && video) {
        popup.style.display = 'flex'; // classList 대신 직접 스타일 적용
        popup.classList.add('active');
        document.body.style.overflow = 'hidden';
        
        // 동영상 로드 및 재생 (약간의 지연)
        setTimeout(() => {
            video.load();
        }, 100);
        
        console.log('🎬 Video popup opened');
    }
};

window.YPP.closeVideoPopup = function() {
    const popup = document.getElementById('video-popup');
    const video = document.getElementById('popup-video');
    
    if (popup && video) {
        popup.classList.remove('active');
        setTimeout(() => {
            popup.style.display = 'none';
        }, 300);
        document.body.style.overflow = 'auto';
        
        // 동영상 정지
        video.pause();
        video.currentTime = 0;
        
        console.log('🎬 Video popup closed');
    }
};

// 전역 함수로 등록 (하위 호환성)
window.openVideoPopup = window.YPP.openVideoPopup;
window.closeVideoPopup = window.YPP.closeVideoPopup;

// 중복 ESC 이벤트 방지
if (!window.YPP.videoEscapeHandlerAdded) {
    document.addEventListener('keydown', function(e) {
        if (e.key === 'Escape') {
            window.YPP.closeVideoPopup();
        }
    });
    window.YPP.videoEscapeHandlerAdded = true;
}

// 함수 존재 확인
console.log(typeof window.openVideoPopup); // "function"이어야 함
console.log(typeof window.YPP.openVideoPopup); // "function"이어야 함

// 요소 존재 확인
console.log(document.getElementById('video-popup')); // null이면 문제
console.log(document.getElementById('popup-video')); // null이면 문제

// 수동 팝업 테스트
window.YPP.openVideoPopup();
</script>