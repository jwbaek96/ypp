<!DOCTYPE html>
<html lang="ko">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    
    <!-- SEO Î©îÌÉÄ ÌÉúÍ∑∏ -->
    <title>Ïù∏ÏÇ¨Ïù¥Îìú - YPP</title>
    <meta name="description" content="YPP Ïù∏ÏÇ¨Ïù¥Îìú - Í≥µÍ∞úÏö© Í∞§Îü¨Î¶¨">
    <meta name="keywords" content="YPP, Ïù∏ÏÇ¨Ïù¥Îìú, Í∞§Îü¨Î¶¨, Í≥µÍ∞úÏö©">
    
    <!-- ÌååÎπÑÏΩò -->
    <link rel="icon" type="image/ico" href="../../../assets/images/favicon/favicon.ico">
    
    <!-- CSS -->
    <link rel="stylesheet" href="../../../css/style.css">
    <link rel="stylesheet" href="../../../css/pages/layout.css">
    
    <!-- Î©îÌÉÄ ÏãúÏä§ÌÖú -->
    <script src="../../../js/head-meta.js"></script>
    
    <!-- Font Awesome -->
    <script src="https://kit.fontawesome.com/e4704dcbbd.js" crossorigin="anonymous"></script>
</head>
<body>
    <!-- Header Container -->
    <div id="header-container"></div>
    
    <!-- Mobile Sidebar Container -->
    <div id="sidebar-container"></div>

    <!-- Main Content -->
    <main class="main-content">
        <!-- Page Header -->
        <section class="page-header">
            <div class="container">
                <div class="page-header-content">
                    <h1 class="page-title"
                        data-eng="YPP Inside"
                        data-kor="YPP Ïù∏ÏÇ¨Ïù¥Îìú">Ïù∏ÏÇ¨Ïù¥Îìú</h1>
                    <p class="page-subtitle"
                        data-eng="Company Life and Activities"
                        data-kor="YPP ÎÇ¥Î∂Ä Î™®ÏäµÍ≥º ÌôúÎèô">YPP ÎÇ¥Î∂Ä Î™®ÏäµÍ≥º ÌôúÎèô</p>
                </div>
            </div>
        </section>

        <!-- Breadcrumb -->
        <section class="breadcrumb-section">
            <div class="container">
                <nav class="breadcrumb">
                    <a href="/"data-eng="Home"data-kor="Ìôà">Ìôà</a>
                    <span class="breadcrumb-separator">></span>
                    <span data-eng="Media"data-kor="ÌôçÎ≥¥">ÌôçÎ≥¥</span>
                    <span class="breadcrumb-separator">></span>
                    <span data-eng="Gallery"data-kor="Í∞§Îü¨Î¶¨">Í∞§Îü¨Î¶¨</span>
                    <span class="breadcrumb-separator">></span>
                    <span class="breadcrumb-current"
                            data-eng="Inside"
                            data-kor="Ïù∏ÏÇ¨Ïù¥Îìú">Ïù∏ÏÇ¨Ïù¥Îìú</span>
                </nav>
            </div>
        </section>

        <!-- Content Section -->
        <section class="content-section" style="min-height: 500px;">
            <div class="container">
                <div class="content-header">
                    <h2 class="content-title"
                        data-eng="Inside Gallery"
                        data-kor="Ïù∏ÏÇ¨Ïù¥Îìú Í∞§Îü¨Î¶¨">Ïù∏ÏÇ¨Ïù¥Îìú Í∞§Îü¨Î¶¨</h2>
                    <p class="content-subtitle"
                        data-eng="Everyday life and special moments at YPP"
                        data-kor="YPPÏùò ÏùºÏÉÅÍ≥º ÌäπÎ≥ÑÌïú ÏàúÍ∞ÑÎì§">YPPÏùò ÏùºÏÉÅÍ≥º ÌäπÎ≥ÑÌïú ÏàúÍ∞ÑÎì§</p>
                </div>
                
                <div class="content-grid">
                    <!-- Inside Gallery -->
                    <div id="inside-gallery-section" class="content-block full-width">
                        <h3 class="block-title" style="display: none;">Inside</h3>
                        <div class="block-content">
                            <div id="inside-gallery" class="gallery-container">
                                <!-- Gallery Grid will be populated by JavaScript -->
                                <div class="gallery-grid" id="inside-gallery-grid">
                                    <!-- Gallery items will be dynamically loaded -->
                                </div>
                                
                                <!-- Pagination -->
                                <div class="pagination-container" id="inside-pagination"></div>
                            </div>
                        </div>
                    </div>
                </div>
            </div>
        </section>
    </main>

    <!-- Image Popup Modal -->
    <div id="imageModal" class="image-modal">
        <div class="modal-content">
            <span class="close-modal">&times;</span>
            <div class="modal-header">
                <h3 id="modal-title"></h3>
                <p id="modal-date"></p>
            </div>
            <div class="modal-body">
                <div class="image-container" id="image-container">
                    <div class="image-touch-area left-touch" data-direction="prev"></div>
                    <div class="image-touch-area right-touch" data-direction="next"></div>
                    <img id="modal-image" src="" alt="">
                </div>
                <p id="modal-description"></p>
            </div>
            <div class="modal-footer">
                <button class="nav-btn prev-btn" id="prevImage">&lt;</button>
                <div class="image-counter">
                    <span id="current-image">1</span> / <span id="total-images">1</span>
                </div>
                <button class="nav-btn next-btn" id="nextImage">&gt;</button>
            </div>
        </div>
    </div>

    <!-- Footer Container -->
    <div id="footer-container"></div>

    <!-- Scripts -->
    <script src="../../../js/components.js"></script>
    <script src="../../../js/header-menu.js"></script>
    <script src="../../../js/sidebar.js"></script>
    <script src="../../../js/hamburger.js"></script>
    <script src="../../../js/main-top-padding.js"></script>
    
    <!-- _________________________________________ -->
    <!-- Ïä§ÌÅ¨Î°§ ÌÉë Î≤ÑÌäº -->
    <div id="scrolltotop-container"></div>
    <!-- ÏµúÏÉÅÎã® Í∞ÄÍ∏∞ Î≤ÑÌäº Íµ¨ÌòÑÌïòÍ∏∞ -->
    <script src="/js/scrolltotop.js"></script>
    <script src="/js/lang-switch.js"></script>
    
    <!-- Inside Gallery Script -->
    <script>

// Î∞∞Ìè¨ ID
const DEPLOYMENT_ID = 'AKfycbwjhJWxaA9U48Rg_WBB1h-viX3y_d9dVKud5nEmDUfS6hn35jiICvvTnAbQ-9XuvkQj';
// Ïõπ Ïï± URL
const GOOGLE_APPS_SCRIPT_URL = `https://script.google.com/macros/s/${DEPLOYMENT_ID}/exec`;
// Ï†ÑÏó≠ Î≥ÄÏàò ÏÑ†Ïñ∏
let insideGalleryData = [];

async function loadGalleryDataFromSheets() {
    try {
        console.log('üìä Google SheetsÏóêÏÑú Í∞§Îü¨Î¶¨ Îç∞Ïù¥ÌÑ∞ Î°úÎìú ÏãúÏûë...');
        
        const response = await fetch(`${GOOGLE_APPS_SCRIPT_URL}?category=all`);
        const result = await response.json();
        
        if (result.success) {
            console.log(`‚úÖ Ï¥ù ${result.data.length}Í∞úÏùò Îç∞Ïù¥ÌÑ∞Î•º ÏÑ±Í≥µÏ†ÅÏúºÎ°ú Î°úÎìúÌñàÏäµÎãàÎã§.`);
            
            // inside Ïπ¥ÌÖåÍ≥†Î¶¨ Îç∞Ïù¥ÌÑ∞Îßå ÌïÑÌÑ∞ÎßÅ
            insideGalleryData = result.data.filter(item => 
                item.category && item.category.toLowerCase() === 'inside'
            ).reverse();
            
            console.log(`üìã Inside Í∞§Îü¨Î¶¨: ${insideGalleryData.length}Í∞ú`);
            console.log(insideGalleryData);

            return true;
        } else {
            throw new Error(`API Ïò§Î•ò: ${result.error || 'Ïïå Ïàò ÏóÜÎäî Ïò§Î•ò'}`);
        }
        
    } catch (error) {
        console.error('üí• Í∞§Îü¨Î¶¨ Îç∞Ïù¥ÌÑ∞ Î°úÎìú Ïã§Ìå®:', error);
        // Ïò§Î•ò Î∞úÏÉù Ïãú Îπà Î∞∞Ïó¥Î°ú Ï¥àÍ∏∞Ìôî
        insideGalleryData = [];
        return false;
    }
}

// Inside Gallery Controller Class
class InsideGalleryController {
    constructor(data, containerId, itemsPerPage = 12) {
        this.data = data.filter(item => item.state === "on");
        this.container = document.getElementById(containerId);
        this.itemsPerPage = itemsPerPage;
        this.currentPage = 1;
        this.totalPages = Math.ceil(this.data.length / this.itemsPerPage);
        this.currentModal = null;
        this.currentImageIndex = 0;
        
        this.init();
    }

    init() {
        this.renderGallery();
        this.renderPagination();
        this.setupModal();
    }

    renderGallery() {
        const startIndex = (this.currentPage - 1) * this.itemsPerPage;
        const endIndex = startIndex + this.itemsPerPage;
        const currentItems = this.data.slice(startIndex, endIndex);

        const galleryGrid = document.getElementById('inside-gallery-grid');
        galleryGrid.innerHTML = '';

        currentItems.forEach(item => {
            const galleryItem = document.createElement('div');
            galleryItem.className = 'gallery-item';
            
            const thumbnailImage = item.image[0];                    
            galleryItem.innerHTML = `
                <div class="gallery-thumbnail" data-id="${item.id}">
                    <img src="${thumbnailImage}" alt="${item.titleKR}" loading="lazy">
                    <div class="gallery-overlay">
                        <div class="gallery-info">
                            <h4 class="gallery-title" data-eng="${item.titleEN}" data-kor="${item.titleKR}">${item.titleKR}</h4>
                            <p class="gallery-date">${this.formatDate(item.date)}</p>
                        </div>
                    </div>
                </div>
            `;

            galleryItem.addEventListener('click', () => {
                this.openModal(item);
            });

            galleryGrid.appendChild(galleryItem);
        });
    }

    renderPagination() {
        const paginationContainer = document.getElementById('inside-pagination');
        paginationContainer.innerHTML = '';

        if (this.totalPages <= 1) return;

        const pagination = document.createElement('div');
        pagination.className = 'pagination';

        // Previous button
        if (this.currentPage > 1) {
            const prevBtn = document.createElement('button');
            prevBtn.className = 'pagination-btn';
            prevBtn.innerHTML = '&lt;';
            prevBtn.addEventListener('click', () => {
                this.currentPage--;
                this.renderGallery();
                this.renderPagination();
            });
            pagination.appendChild(prevBtn);
        }

        // Page numbers
        for (let i = 1; i <= this.totalPages; i++) {
            const pageBtn = document.createElement('button');
            pageBtn.className = `pagination-btn ${i === this.currentPage ? 'active' : ''}`;
            pageBtn.textContent = i;
            pageBtn.addEventListener('click', () => {
                this.currentPage = i;
                this.renderGallery();
                this.renderPagination();
            });
            pagination.appendChild(pageBtn);
        }

        // Next button
        if (this.currentPage < this.totalPages) {
            const nextBtn = document.createElement('button');
            nextBtn.className = 'pagination-btn';
            nextBtn.innerHTML = '&gt;';
            nextBtn.addEventListener('click', () => {
                this.currentPage++;
                this.renderGallery();
                this.renderPagination();
            });
            pagination.appendChild(nextBtn);
        }

        paginationContainer.appendChild(pagination);
    }

    setupModal() {
        const modal = document.getElementById('imageModal');
        const closeBtn = document.querySelector('.close-modal');
        const prevBtn = document.getElementById('prevImage');
        const nextBtn = document.getElementById('nextImage');
        const imageContainer = document.getElementById('image-container');
        const leftTouchArea = document.querySelector('.left-touch');
        const rightTouchArea = document.querySelector('.right-touch');

        // Touch/Drag variables
        let startX = 0;
        let startY = 0;
        let isDragging = false;
        let dragThreshold = 50;

        // Close modal
        closeBtn.addEventListener('click', () => {
            this.closeModal();
        });

        modal.addEventListener('click', (e) => {
            if (e.target === modal) {
                this.closeModal();
            }
        });

        // Navigation buttons
        prevBtn.addEventListener('click', () => {
            this.showPreviousImage();
        });

        nextBtn.addEventListener('click', () => {
            this.showNextImage();
        });

        // Touch area clicks
        leftTouchArea.addEventListener('click', () => {
            this.showPreviousImage();
        });

        rightTouchArea.addEventListener('click', () => {
            this.showNextImage();
        });

        // Touch events for mobile
        imageContainer.addEventListener('touchstart', (e) => {
            startX = e.touches[0].clientX;
            startY = e.touches[0].clientY;
            isDragging = true;
        }, { passive: true });

        imageContainer.addEventListener('touchmove', (e) => {
            if (!isDragging) return;
            e.preventDefault();
        }, { passive: false });

        imageContainer.addEventListener('touchend', (e) => {
            if (!isDragging) return;
            
            const endX = e.changedTouches[0].clientX;
            const endY = e.changedTouches[0].clientY;
            const diffX = startX - endX;
            const diffY = startY - endY;

            if (Math.abs(diffX) > Math.abs(diffY) && Math.abs(diffX) > dragThreshold) {
                if (diffX > 0) {
                    this.showNextImage();
                } else {
                    this.showPreviousImage();
                }
            }
            
            isDragging = false;
        }, { passive: true });

        // Mouse drag events for desktop
        imageContainer.addEventListener('mousedown', (e) => {
            startX = e.clientX;
            startY = e.clientY;
            isDragging = true;
            imageContainer.style.cursor = 'grabbing';
        });

        imageContainer.addEventListener('mousemove', (e) => {
            if (!isDragging) return;
            e.preventDefault();
        });

        imageContainer.addEventListener('mouseup', (e) => {
            if (!isDragging) return;
            
            const endX = e.clientX;
            const endY = e.clientY;
            const diffX = startX - endX;
            const diffY = startY - endY;

            if (Math.abs(diffX) > Math.abs(diffY) && Math.abs(diffX) > dragThreshold) {
                if (diffX > 0) {
                    this.showNextImage();
                } else {
                    this.showPreviousImage();
                }
            }
            
            isDragging = false;
            imageContainer.style.cursor = 'grab';
        });

        imageContainer.addEventListener('mouseleave', () => {
            isDragging = false;
            imageContainer.style.cursor = 'grab';
        });

        // Keyboard navigation
        document.addEventListener('keydown', (e) => {
            if (modal.style.display === 'block') {
                if (e.key === 'Escape') {
                    this.closeModal();
                } else if (e.key === 'ArrowLeft') {
                    this.showPreviousImage();
                } else if (e.key === 'ArrowRight') {
                    this.showNextImage();
                }
            }
        });
    }

    openModal(item) {
        this.currentModal = item;
        this.currentImageIndex = 0;
        
        const modal = document.getElementById('imageModal');
        const modalTitle = document.getElementById('modal-title');
        const modalDate = document.getElementById('modal-date');
        const modalDescription = document.getElementById('modal-description');
        const totalImages = document.getElementById('total-images');

        modalTitle.textContent = item.titleKR;
        modalTitle.setAttribute('data-eng', item.titleEN);
        modalTitle.setAttribute('data-kor', item.titleKR);
        modalDate.textContent = this.formatDate(item.date);
        modalDescription.textContent = item.textKR || item.text || '';
        totalImages.textContent = item.image.length;

        this.updateModalImage();
        modal.style.display = 'block';
        document.body.style.overflow = 'hidden';
    }

    closeModal() {
        const modal = document.getElementById('imageModal');
        modal.style.display = 'none';
        document.body.style.overflow = 'auto';
        this.currentModal = null;
    }

    showPreviousImage() {
        if (this.currentModal && this.currentImageIndex > 0) {
            this.currentImageIndex--;
            this.updateModalImage();
        }
    }

    showNextImage() {
        if (this.currentModal && this.currentImageIndex < this.currentModal.image.length - 1) {
            this.currentImageIndex++;
            this.updateModalImage();
        }
    }

    updateModalImage() {
        if (!this.currentModal) return;

        const modalImage = document.getElementById('modal-image');
        const currentImageSpan = document.getElementById('current-image');
        
        modalImage.src = this.currentModal.image[this.currentImageIndex];
        modalImage.alt = this.currentModal.titleKR;
        currentImageSpan.textContent = this.currentImageIndex + 1;

        // Update navigation buttons state
        const prevBtn = document.getElementById('prevImage');
        const nextBtn = document.getElementById('nextImage');
        
        prevBtn.style.display = 'flex';
        nextBtn.style.display = 'flex';
        
        prevBtn.disabled = this.currentImageIndex === 0;
        nextBtn.disabled = this.currentImageIndex === this.currentModal.image.length - 1;
        
        if (this.currentModal.image.length <= 1) {
            prevBtn.style.display = 'none';
            nextBtn.style.display = 'none';
        }
    }

    formatDate(dateString) {
        const date = new Date(dateString);
        return date.toLocaleDateString('ko-KR', {
            year: 'numeric',
            month: 'long',
            day: 'numeric'
        });
    }
}

// Í∏∞Ï°¥ DOMContentLoaded Ïù¥Î≤§Ìä∏Î•º ÏàòÏ†ï
document.addEventListener('DOMContentLoaded', async function() {
    // Google SheetsÏóêÏÑú Îç∞Ïù¥ÌÑ∞ Î°úÎìú
    const success = await loadGalleryDataFromSheets();
    
    if (success) {
        // Inside Í∞§Îü¨Î¶¨ Ïª®Ìä∏Î°§Îü¨ Ï¥àÍ∏∞Ìôî
        new InsideGalleryController(insideGalleryData, 'inside-gallery-section');
    } else {
        console.error('Í∞§Îü¨Î¶¨ Îç∞Ïù¥ÌÑ∞ Î°úÎìú Ïã§Ìå®Î°ú Îπà Í∞§Îü¨Î¶¨Î•º ÌëúÏãúÌï©ÎãàÎã§.');
        // Ïã§Ìå®Ìï¥ÎèÑ Îπà Î∞∞Ïó¥Î°ú Í∞§Îü¨Î¶¨ Ï¥àÍ∏∞Ìôî
        new InsideGalleryController([], 'inside-gallery-section');
    }
});
</script>

</body>
</html>

<style>
/* ===== INSIDE PAGE SPECIFIC STYLES ===== */

/* Content Section */
.content-section {
    padding: 3rem 0;
    background-color: var(--white, #ffffff);
}

/* Gallery Content */
.gallery-content {
    margin-top: 2rem;
}

.gallery-grid {
    display: grid;
    grid-template-columns: repeat(auto-fit, minmax(300px, 1fr));
    gap: 1.5rem;
}

.gallery-placeholder {
    min-height: 400px;
    background-color: var(--background-light, #f8f9fa);
    border: 1px solid var(--border-light, #e5e5e5);
    border-radius: 8px;
    display: flex;
    align-items: center;
    justify-content: center;
    color: var(--text-secondary, #666);
}

/* Responsive */
@media (max-width: 768px) {
    .gallery-grid {
        grid-template-columns: 1fr;
        gap: 1rem;
    }
    
    .gallery-placeholder {
        min-height: 300px;
    }
}
</style>